---
title: Уязвимости сети Предприятия
date: 2019-05-10
author: Якунин ДИ
briefly: Уязвимости сети
---
## 1.1. Анализ уязвимостей сети

Сеть Предприятия может подвергаться атакам различных вирусных программ,
проникших в компьютеры при скачивании зараженных файлов из интернета или
при запуске вложений электронной почты.

Большинство таких атак блокируются антивирусами, однако полной гарантии
защиты они не дают.

Для мониторинга сетевой уязвимости в процессе исследования сети была
внедрена система OSSIM  (Open Source Security Information Management)
--- система управления, контроля и обеспечения информационной
безопасности. \[13\]

OSSIM включает в себя такой функционал как:

-   Сбор, анализ и корреляция событий --- SIEM

-   Хостовая система обнаружения вторжений (HIDS)
    --- [OSSEC](http://ossec.net/)

-   Сетевая система обнаружения вторжений (NIDS)
    --- [Suricata](http://suricata-ids.org/)

-   Беспроводная система обнаружения вторжений (WIDS)
    --- [Kismet](https://www.kismetwireless.net/)

-   Мониторинг узлов сети- [Nagios](http://www.nagios.org/)

-   Анализ сетевых аномалий
    -- [P0f](http://lcamtuf.coredump.cx/p0f3/), [PADS](http://passive.sourceforge.net/about.php), [FProbe](http://fprobe.sourceforge.net/), [Arpwatch ](http://ee.lbl.gov/)и
    др.

-   Сканер уязвимостей -- [OpenVAS](http://www.openvas.org/)

-   Мощнейшая система обмена информацией об угрозах между пользователями
    OSSIM --- [OTX](https://www.alienvault.com/open-threat-exchange)

-   Более 200 плагинов для парсинга и корреляции логов со всевозможных
    внешних устройств и служб

<img src="http://localhost:8000/img/image1.jpg">

Рисунок 1.1. Система управления, контроля и обеспечения ИБ.

 OSSIM   обеспечивает максимальную интеграцию разнородных утилит в
пределах единой открытой архитектуры. В результате появляется
возможность накапливать данные, находить и отслеживать четкие
взаимосвязи в собранной информации. Источниками служат практически любые
утилиты, способные обрабатывать сетевую или системную информацию в
реальном времени.

Сетевые системы Предприятия подвергаются детальному анализу, для чего
собирается информация о типичном их использовании (например, средний
трафик за день), активности пользователя (почта, http, ftp и т.п.) и
производится мониторинг сессии в реальном времени с возможностью
отобразить характер активности машины в сети.

На основании данных мониторинга OSSIM следит за связями отдельных
компьютеров и вычисляет составной риск. Для этого строятся графики
постоянных ТСР-сессий, графики изменяющихся UDP, TCP и ICMP связей, что
позволяет идентифицировать сетевые атаки, совершаемые одновременно на
несколько компьютеров. В результате OSSIM может работать как система
предотвращения атак (IPS, Intrusion Prevention System), основываясь на
коррелированных данных, собранных со всех источников. 

После установки системы были выявлены несколько событий нарушения ИБ.

Были обнаружены попытки атак типа \"подбор паролей\" к файловому серверу
с компьютеров внутренней сети (рисунки 3.2, 3.3).

На этих компьютерах стояли антивирусы с необновляемыми базами и
присутствовали зараженные файлы. После обнаружения были приняты меры,
устраняющие эти нарушения.

<img src="http://localhost:8000/img/image2.jpg">

Рисунок 1.2. Атаки типа \"подбор пароля\" с локальных компьютеров на
сервер.

<img src="http://localhost:8000/img/image3.jpg">

Рисунок 1.3. Детали атаки.

Действия, которые необходимо выполнить при возникновении событий
нарушения информационной безопасности, которые зафиксирует OSSIM,
описаны в разработанном документе \"Политика управления инцидентами\".

## 1.2. Уязвимости доступа к данным серверов 

Самая важная функция серверов -- обеспечение постоянной доступности
информации для авторизованных пользователей Предприятия. Для этого
сервера должны устойчиво работать на протяжении рабочего времени
Предприятия и быть доступны по сети.

Для обеспечения устойчивой работы и защиты питания серверов используются
ИБП, однако они не имеют связи с программным обеспечением. Поэтому, при
длительном отключении питании серверов аккумуляторы ИБП могут
разрядиться, произойдет внезапное отключение, и данные могут быть
потеряны. Кроме потери данных могут пострадать накопители информации
серверов.

Для предотвращения этого, ИБП были подключены к серверами специальными
кабелями, через которые подаются сигналы о том, что произошло отключение
и нужно срочно закрыть все программы для исключения потери данных. После
закрытия всех программ сервер отключается.

Для контроля доступности серверов Предприятия и анализа их
работоспособности была внедрена система распределенного мониторинга
корпоративного класса с открытыми исходными кодами Zabbix.

Zabbix - это программное обеспечение для мониторинга многочисленных
параметров сети, жизнеспособности и целостности серверов. Zabbix
использует гибкий механизм оповещений, что позволяет пользователям
конфигурировать уведомления основанные на e-mail практически для любого
события. Это позволяет быстро реагировать на проблемы с серверами.
Zabbix предлагает отличные функции отчетности и визуализации данных
основанные на данных истории. \[14\]

На основании анализа отчетов Zabbix были выявлены некоторые проблемы с
серверами (рисунки 1.4 - 1.7).

<img src="http://localhost:8000/img/image4.jpg">

Рисунок 1.4. Проблема с доступом к серверу PVL-IS-001.

<img src="http://localhost:8000/img/image5.jpg">

Рисунок 1.5. Проблема с доступом к серверу PVL-IS-001 решена.

<img src="http://localhost:8000/img/image6.jpg">

Рисунок 1.6. Проблема с виртуальной памятью, не стартовал сервис.

<img src="http://localhost:8000/img/image7.jpg">

Рисунок 1.7. Свободная память менее 270 МБ.

Все выявленные проблемы были успешно устранены.

Действия, которые необходимо выполнить при возникновении событий
нарушения доступности и работоспособности серверов и компьютеров,
которые зафиксирует ZABBIX, описаны в разработанном документе \"Политика
управления инцидентами\".
